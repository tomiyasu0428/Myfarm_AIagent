# アグリエージェント 開発タスクリスト

**プロジェクトビジョン:** 「考えるプロセスをなくし、AIが次の一手を指南する」

このドキュメントは、Google Agents SDK (ADK) を用いた農業管理AIエージェントの開発タスクを管理します。

---

## ✅ タスクチェックリスト (Dataview TASK 用)

### フェーズ1: 基盤構築
- [x] **T-01** ADK開発環境セットアップ
    - [x] T-01-01 Python仮想環境の構築 (venv)
    - [x] T-01-02 Google Cloudプロジェクト設定と認証
    - [x] T-01-03 `google-adk` ライブラリのインストール
    - [x] T-01-04 ADKプロジェクト構造の作成
    - [x] T-01-05 認証情報の`.env`集約
- [ ] **T-02** Airtable操作ツールの開発 (FunctionTool)
    - [x] T-02-01 Airtableクライアント初期化関数
    - [x] T-02-02 ツール: 今日の作業タスク取得 (`get_today_tasks`)
    - [x] T-02-03 ツール: 圃場情報の取得 (`get_field_info`)
    - [x] T-02-04 ツール: 資材情報（農薬・肥料）の検索 (`search_materials`)
    - [x] T-02-05 ツール: 日報の作成 (`create_daily_report`)
    - [x] T-02-06 ツール: タスクステータスの更新 (`update_task_status`)
- [ ] **T-03** 基本エージェントの構築とテスト
    - [ ] T-03-01 `LlmAgent` の定義 (`agent.py`)
    - [ ] T-03-02 `adk web` でローカル動作確認

### フェーズ2: インテリジェント機能開発
- [ ] **T-04** インテリジェントなタスク管理・提案エージェントの開発
    - [ ] T-04-01 [ツール] 作付計画からのタスク自動生成
    - [ ] T-04-02 [子エージェント] 状況分析担当（天候、生育状況）
    - [ ] T-04-03 [子エージェント] 動的タスク提案担当（防除、施肥、収穫）
    - [ ] T-04-04 [親エージェント] 総合管理・オーケストレーション担当
    - [ ] T-04-05 `instruction` の高度化
- [ ] **T-05** LINE連携の実装
    - [ ] T-05-01 LINE Messaging API Webhook処理
    - [ ] T-05-02 LINEユーザーと作業者マスターの紐付け
    - [ ] T-05-03 定期タスク通知機能
    - [ ] T-05-04 リッチメニューの作成と設定

### フェーズ3: 本番化・運用
- [ ] **T-06** 評価とテスト
    - [ ] T-06-01 評価用テストケースの作成
    - [ ] T-06-02 `AgentEvaluator` で性能評価
- [ ] **T-07** デプロイ
    - [ ] T-07-01 `adk deploy cloudrun` で本番環境デプロイ
    - [ ] T-07-02 Vertex AI Agent Engine移行検討
- [ ] **T-08** モニタリングと改善
    - [ ] T-08-01 ログ収集とモニタリング環境の構築
    - [ ] T-08-02 ユーザーフィードバック収集と改善サイクル

---

## フェーズ1: 基盤構築 (ADK & Airtable連携)

**目標:** ADKの環境を構築し、Airtableの農作業データを操作するための基本的な「ツール」を開発する。

| タスクID    | タスク名                                        | 関連要件             | ステータス | 備考                                                           |
| -------- | ------------------------------------------- | ---------------- | ----- | ------------------------------------------------------------ |
| **T-01** | **ADK開発環境セットアップ**                           | -                | 完了   |                                                              |
| T-01-01  | Python仮想環境の構築 (`venv`)                      | -                | 完了   | Python 3.9以上                                                 |
| T-01-02  | Google Cloudプロジェクト設定と認証                     | -                | 完了   | Vertex AI APIの有効化、`gcloud auth application-default login`の実行 |
| T-01-03  | `google-adk` ライブラリのインストール                   | -                | 完了   | `pip install google-adk`
| T-01-04  | ADKプロジェクト構造の作成                              | -                | 完了   | `agent.py`, `__init__.py`, `.env` ファイルの配置                    |
| T-01-05  | 認証情報（APIキー等）の`.env`への集約                     | NF-01            | 完了   | Airtable, LINE, Google Cloudのキーを管理                           |
| **T-02** | **Airtable操作ツールの開発 (FunctionTool)**         | F-01, F-02, F-03 | 完了   | ADKエージェントが利用する基本的な能力を関数として定義する                               |
| T-02-01  | Airtableクライアント初期化関数                         | -                | 完了   | `airtable-python-wrapper` を利用                                |
| T-02-02  | **ツール:** 今日の作業タスク取得 (`get_today_tasks`)     | F-01             | 完了   | 指定された作業者の今日のタスクをAirtableから取得する                               |
| T-02-03  | **ツール:** 圃場情報の取得 (`get_field_info`)         | F-01             | 完了   | 圃場名を指定して、作付け情報や土壌データを取得する                                    |
| T-02-04  | **ツール:** 資材情報（農薬・肥料）の検索 (`search_materials`) | F-01             | 完了   | 作物名や用途から、使用可能な資材（農薬・肥料）をAirtableから検索する |
| T-02-05  | **ツール:** 日報の作成 (`create_daily_report`)      | F-02             | 完了   | LINEからの報告を`日報ログ`テーブルに記録する                               |
| T-02-06  | **ツール:** タスクステータスの更新 (`update_task_status`) | F-03             | 完了   | 日報の内容に基づき、タスクのステータスを「完了」などに変更する                          |
| **T-03** | **基本エージェントの構築とテスト**                         | -                | 未着手   |                                                              |
| T-03-01  | `LlmAgent` の定義 (`agent.py`)                 | -                | 未着手   | `T-02`で作成したツール群を`tools`パラメータに設定                              |
| T-03-02  | `adk web` を用いたローカルでの動作確認                    | -                | 未着手   | 「今日のタスクは？」といった簡単な質問に応答できることを確認する                             |

---

## フェーズ2: インテリジェント機能開発 (AI提案能力の強化)

**目標:** AIが状況を判断し、圃場全体の農作業（防除・施肥／潅水・収穫・リマインド等）について具体的な次のアクションを提案する、思考代行エージェント群を開発する。

| タスクID | タスク名 | 関連要件 | ステータス | 備考 |
|---|---|---|---|---|
| **T-04** | **インテリジェントなタスク管理・提案エージェントの開発** | F-06 | 未着手 | Airtableの計画と連携した、動的なタスク管理を実現する |
| T-04-01 | **[ツール] 作付計画からのタスク自動生成** | F-04, F-06 | 未着手 | `作付計画`と`Crop Task Template`に基づき`作業タスク`を自動生成するツールを開発 |
| T-04-02 | **[子エージェント] 状況分析担当** | F-06 | 未着手 | 圃場情報、天候、生育状況をツールで収集・分析し、親エージェントにコンテキストを提供する |
| T-04-03 | **[子エージェント] 動的タスク提案担当** | F-06 | 未着手 | 状況分析に基づき、防除・施肥・収穫などの追加・変更タスクをAirtableのスキーマに沿って提案する |
| T-04-04 | **[親エージェント] 総合管理・オーケストレーション担当** | F-06 | 未着手 | ユーザーからの質問を受け、タスク生成ツールや子エージェント群を適切に呼び出し、最終的な回答を生成する |
| T-04-05 | `instruction` の高度化 | F-06 | 未着手 | 「あなたは熟練の農業コンサルタントです」といった役割定義と行動指針を具体的に記述 |
| **T-05** | **LINE連携の実装** | F-07, F-08, F-09 | 未着手 | |
| T-05-01 | LINE Messaging APIのWebhook処理 | - | 未着手 | Google Cloud FunctionsでADKエージェントを呼び出す |
| T-05-02 | LINEユーザーと作業者マスターの紐付け | F-07 | 未着手 | `Session` や `Memory` を活用したユーザー管理 |
| T-05-03 | 定期的なタスク通知機能の実装 | F-04-01 | 未着手 | Google Cloud SchedulerからWebhookを叩き、プッシュ通知を送信 |
| T-05-04 | リッチメニューの作成と設定 | F-09 | 未着手 | 「今日のタスク」「農業相談」などのショートカットを配置 |

---

## フェーズ3: 本番化・運用

**目標:** 開発したエージェントを安定的に運用し、継続的に改善していくための評価・デプロイ体制を構築する。

| タスクID | タスク名 | 関連要件 | ステータス | 備考 |
|---|---|---|---|---|
| **T-06** | **評価とテスト** | - | 未着手 | |
| T-06-01 | 評価用テストケースの作成 | - | 未着手 | 「A畑のトマト、雨が降った後の最適な作業は？」などのシナリオを定義 |
| T-06-02 | `AgentEvaluator` を用いた性能評価 | - | 未着手 | 提案の精度やツールの呼び出しが適切かを確認 |
| **T-07** | **デプロイ** | - | 未着手 | |
| T-07-01 | `adk deploy cloudrun` を用いたデプロイ | - | 未着手 | まずはCloud Runでサーバーレス環境にデプロイ |
| T-07-02 | (将来) Vertex AI Agent Engineへの移行検討 | - | 未着手 | より高度な運用とスケーラビリティが必要になった場合に検討 |
| **T-08** | **モニタリングと改善** | NF-03 | 未着手 | |
| T-08-01 | ログ収集とモニタリング環境の構築 | NF-03 | 未着手 | Google Cloud's operations suite (Logging, Monitoring) を活用 |
| T-08-02 | ユーザーフィードバックの収集と改善サイクル | - | 未着手 | |